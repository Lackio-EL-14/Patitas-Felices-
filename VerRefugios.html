<!DOCTYPE html>
<html lang="es">

<body>
  <title>Refugios</title>
  <link rel="stylesheet" href="styles.css">
</body>
<nav class="navbar">
  <div class="logo">
    <img src="imagenes/logo.jpeg" alt="logo Patitas Felices" class="logo-img" />
  </div>

  <div class="nav-links">
    <a href="panel-solicitudes-adopcion.html" class="nav-item">Solicitudes</a>
    <a href="seguimiento-mascota.html" class="nav-item">Seguimiento</a>
    <a href="VerAdopciones.html" class="nav-item">Adopciones</a>
    <a href="VerRefugios.html" class="nav-item">Refugios</a>

    <a href="./lost-dogs.html" class="nav-item active">Extraviados</a>
  </div>

</nav>
<h1>Todos los Refugios</h1>

<div style="margin: 20px 0;">
  <label for="filtro-nombre">Buscar por nombre:</label>
  <input 
    type="text" 
    id="filtro-nombre" 
    data-testid="input-nombre"
    placeholder="Ejemplo: Huellitas"
  />
  <label for="filtro-departamento" style="margin-left: 20px;">Departamento:</label>
  <select 
    id="filtro-departamento" 
    data-testid="select-departamento"
  >
    <option value="Todos">Todos</option>
  </select>
</div >

<div id="lista-refugios"></div>

<script type="module">
  import RefugioRepository from './src/Ejemplos base/Infraestructure/RefugioRepository.js';
  import buscarRefugiosService from './src/Ejemplos base/Services/buscarRefugiosService.js';

  const repository = new RefugioRepository();
  const service = buscarRefugiosService(repository);
  
  function mostrarRefugios(refugios) {
    const listaRefugios = document.getElementById('lista-refugios');
    listaRefugios.innerHTML = '';
    
    refugios.forEach(refugio => {
      const refugioDiv = document.createElement('div');
      refugioDiv.setAttribute('data-testid', 'refugio-item');
      refugioDiv.innerHTML = `
        <h3>${refugio.nombre}</h3>
        <p>Departamento: ${refugio.departamento}</p>
        <p>Mascotas: ${refugio.capacidad}</p>
      `;
      listaRefugios.appendChild(refugioDiv);
    });
  }

  function aplicarFiltros() {
    const nombre = inputNombre.value;
    const departamento = selectDepartamento.value;
    const refugiosFiltrados = service.filtrarRefugios(nombre, departamento);
    mostrarRefugios(refugiosFiltrados);
  }
  
  const selectDepartamento = document.getElementById('filtro-departamento');
  const departamentos = repository.obtenerDepartamentos();
  departamentos.forEach(depto => {
    const option = document.createElement('option');
    option.value = depto;
    option.textContent = depto;
    selectDepartamento.appendChild(option);
  });

 
  mostrarRefugios(service.obtenerTodosLosRefugios());

 
  const inputNombre = document.getElementById('filtro-nombre');
  inputNombre.addEventListener('input', aplicarFiltros);
  selectDepartamento.addEventListener('change', aplicarFiltros);
</script>

</html>